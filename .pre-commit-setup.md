# Pre-commit Hooks Setup

This project uses [pre-commit](https://pre-commit.com/) to validate files before they're committed.

## What gets checked?

- **JSON files** - Syntax validation
- **YAML files** - Syntax validation
- **Python files** - Syntax validation and formatting (Black)
- **File hygiene** - Trailing whitespace, end-of-file newlines
- **Security** - Detect accidentally committed private keys

## Installation

### One-time setup:

```bash
# Install pre-commit
pip install pre-commit

# Install the git hook scripts
pre-commit install
```

### That's it!

Pre-commit will now run automatically on `git commit`. If any checks fail, the commit will be blocked and files will be auto-fixed where possible.

## Manual usage

```bash
# Run on all files (useful for CI or initial setup)
pre-commit run --all-files

# Run on staged files only
pre-commit run

# Run a specific hook
pre-commit run check-json --all-files

# Skip hooks for a commit (use sparingly!)
git commit --no-verify
```

## What happens when checks fail?

Some hooks **auto-fix** issues:
- Trailing whitespace removed
- Missing newlines added
- Code formatted with Black

Other hooks **block commits** and require manual fixes:
- Invalid JSON/YAML syntax
- Python syntax errors
- Private keys detected

After auto-fixes, you'll need to:
1. Review the changes
2. `git add` the fixed files
3. Retry your commit

## Updating hooks

```bash
# Update to latest versions
pre-commit autoupdate

# Clear cache if hooks misbehave
pre-commit clean
```

## CI/CD Integration

Pre-commit hooks run locally, but the CI/CD pipeline also validates:
- JSON syntax (all `*.json` files)
- Python tests (pytest with 78%+ coverage)
- Postman collection (Newman integration tests)

This provides a safety net if someone bypasses local hooks.
